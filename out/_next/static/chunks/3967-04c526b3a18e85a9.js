"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3967],{513967:function(e,t,o){o.d(t,{default:function(){return U}});var r=o(557437),n=o(902265),i=o(938543),l=o(5894),a=o(888190),s=o(660034),c=o(790658),d=o(977639),p=o(438156),g=o(703460),u=o(422347),f=o(273088),x=o(788986),h=o(273977),b=o(167449),m=o(352581),y=o(899765),k=o(633623),w=o(842858),B=o(820476);let C=function(e,t,o){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,n=t[o];if(!n)return;let i=e.clientWidth,l=n.offsetLeft,a=n.offsetWidth,s=e.scrollWidth-i;e.scrollTo({left:Math.max(0,Math.min(l-i/2+a/2-r,s)),behavior:"smooth"})};var I=o(560087),F=o(383827),v=o(118627),j=o(585010),L=o(684787),A=o(736261),S=o(838516),R=o(741368),Z=o(658720),E=o(511617),z=e=>{let{currentAorId:t,selectedAOR:o}=e,a=(0,l.H)(),s=(0,w.T)(),{t:p}=(0,v.$)(),{categories:g,categoriesLoading:u,categoriesError:f}=(0,w.C)(e=>e.electronicLog),[x,h]=(0,n.useState)(1),[b,m]=(0,n.useState)([0]),[C,F]=(0,n.useState)({0:{categoryId:"",description:"",tags:[],tagInput:"",facility:"",file:null,fileName:""}}),[j,L]=(0,n.useState)(!1),[z,D]=(0,n.useState)(null),[T,W]=(0,n.useState)(null),V=e=>C[e]||{categoryId:"",description:"",tags:[],tagInput:"",facility:"",file:null,fileName:""},N=(e,t)=>{F(o=>({...o,[e]:{...V(e),...t}}))},O=(e,t)=>{let o=t.replace(/\s/g,"").slice(0,10);if(!o||0===o.length)return;let r=V(e);!(r.tags.length>=6)&&(r.tags.includes(o)||N(e,{tags:[...r.tags,o].slice(0,6),tagInput:""}))},M=(e,t)=>{let o=t.target.value.replace(/\s/g,"");if(o.includes("#")){let t=o.split("#");t.forEach((o,r)=>{o&&r<t.length-1&&O(e,o)}),o=t[t.length-1]}N(e,{tagInput:o.slice(0,10)})},_=(e,t)=>{var o;let r=V(e);(" "===t.key||"#"===t.key)&&r.tagInput&&(t.preventDefault(),O(e,r.tagInput)),"Backspace"!==t.key||(null===(o=r.tagInput)||void 0===o?void 0:o.trim())||!r.tags.length||N(e,{tags:r.tags.slice(0,-1)})},P=(e,t)=>{N(e,{categoryId:t.target.value})},H=(e,t)=>{N(e,{description:t.target.value})},U=(e,t)=>{N(e,{facility:t.target.value})},Q=e=>{x>1&&(m(t=>t.filter(t=>t!==e)),h(e=>e-1),F(t=>{let o={...t};return delete o[e],o}))},Y=e=>{var t;let r=V(e);if(!r.categoryId){s((0,y.wp)({type:I.N.Error,message:p("electronicLogBook.selectCategory")}));return}if(!r.description||""===r.description.trim()){s((0,y.wp)({type:I.N.Error,message:p("electronicLogBook.addDescription")}));return}let n=[{categoryId:r.categoryId,tags:r.tags.join(", "),description:r.description,facilities:r.facility,filename:(null===(t=r.file)||void 0===t?void 0:t.name)||""}],i=r.file?[r.file]:[];s((0,B.Im)({payload:n,files:i})).unwrap().then(()=>{s((0,y.wp)({type:I.N.Success,message:p("electronicLogBook.logSuccess")})),m(t=>t.filter(t=>t!==e)),h(e=>e-1),F(t=>{let o={...t};return delete o[e],o}),o&&s((0,B.VV)({shiftAorId:o,sortBy:"updatedAt",sortOrder:"desc",page:1,limit:10}))}).catch(e=>{s((0,y.wp)({type:I.N.Error,message:e}))})},K=e=>{D(e),L(!0)},X=()=>{L(!1),D(null),W(null)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i.Z,{sx:a.addRowContainer,onKeyDown:e=>{"Enter"===e.key&&e.preventDefault()},children:[(0,r.jsx)(i.Z,{sx:a.addRowScrollableContent,children:b.map(e=>{let t=V(e);return(0,r.jsxs)(i.Z,{sx:a.addRowItem,children:[(0,r.jsxs)(i.Z,{sx:a.selectContainer,children:[(0,r.jsxs)("select",{style:a.selectInput,disabled:u,value:t.categoryId,onChange:t=>P(e,t),children:[(0,r.jsx)("option",{value:"",style:{color:"#111",background:"#fff"},children:p("electronicLogBook.selectCategory")}),g.map(e=>(0,r.jsx)("option",{value:e._id,style:{color:"#111",background:"#fff"},children:e.name},e._id))]}),u&&(0,r.jsx)("span",{style:{color:"#fff",fontSize:12},children:p("electronicLogBook.loading")}),f&&(0,r.jsx)("span",{style:{color:"red",fontSize:12},children:f})]}),(0,r.jsxs)(i.Z,{sx:a.selectContainer,children:[t.tags.map((e,t)=>(0,r.jsxs)("span",{style:{display:"inline-block",color:"#fff",fontSize:13,padding:"2px 6px",backgroundColor:"#333",borderRadius:4,whiteSpace:"nowrap",marginRight:6},children:["#",e]},e+t)),(0,r.jsx)("input",{type:"text",style:a.inputfield,placeholder:t.tags.length>=6?p("electronicLogBook.tagplaceholder1"):p("electronicLogBook.tagplaceholder2"),value:t.tagInput,maxLength:10,onChange:t=>M(e,t),onKeyDown:t=>_(e,t),disabled:t.tags.length>=Z.o8})]}),(0,r.jsx)(i.Z,{sx:a.selectContainer,children:(0,r.jsx)("input",{type:"text",placeholder:p("electronicLogBook.facility"),value:t.facility,onChange:t=>{let o=t.target.value.split(",").map(e=>e.trim()).filter(e=>e.length>0);!(o.length>Z.o8)&&(o.some(e=>e.length>13)||U(e,t))},style:a.inputfield})}),(0,r.jsx)(i.Z,{sx:a.flexInput,children:(0,r.jsx)("input",{type:"text",placeholder:p("electronicLogBook.descriptionPlaceholder"),style:a.inputfield,value:t.description,maxLength:Z.Gg,onChange:t=>H(e,t)})}),(0,r.jsx)(A.Z,{onClick:()=>K(e),children:(0,r.jsxs)(i.Z,{sx:{position:"relative"},children:[(0,r.jsx)("img",{src:k.VZ.attachment,alt:"attach",width:22,height:22}),t.file&&(0,r.jsx)(i.Z,{sx:a.filecount,children:"1"})]})}),(0,r.jsx)(A.Z,{onClick:()=>Y(e),children:(0,r.jsx)(E.Z,{sx:{color:"#1976d2",mr:1,mt:-1}})}),(0,r.jsx)(A.Z,{onClick:()=>Q(e),disabled:1===x,children:(0,r.jsx)("img",{src:k.VZ.delete,alt:"delete",width:22,height:22})})]},e)})}),(0,r.jsxs)(i.Z,{sx:a.closeButtonContainer,children:[(0,r.jsxs)(c.Z,{sx:{color:"#fff",fontSize:14},children:[x," row",1!==x?"s":""]}),(0,r.jsxs)(i.Z,{sx:{display:"flex",gap:2},children:[(0,r.jsx)(d.Z,{variant:"outlined",sx:a.addButton,onClick:()=>{if(x<10){let e=Math.max(...b)+1;m(t=>[...t,e]),h(e=>e+1),F(t=>({...t,[e]:{categoryId:"",description:"",tags:[],tagInput:"",facility:"",file:null,fileName:""}}))}},type:"button",disabled:10===x,children:p("electronicLogBook.addRow")}),(0,r.jsx)(d.Z,{variant:"contained",type:"button",sx:{...a.filterButton,backgroundColor:"#1976d2",color:"white"},onClick:()=>{for(let e of b){let t=V(e);if(!t.categoryId){s((0,y.wp)({type:I.N.Error,message:p("electronicLogBook.selectAllrows")}));return}if(!t.description||""===t.description.trim()){s((0,y.wp)({type:I.N.Error,message:p("electronicLogBook.addDescription")}));return}}let e=b.map(e=>{var t;let o=V(e);return{categoryId:o.categoryId,tags:o.tags.join(", "),description:o.description,facilities:o.facility,filename:(null===(t=o.file)||void 0===t?void 0:t.name)||""}}),t=b.map(e=>V(e).file).filter(e=>null!==e);s((0,B.Im)({payload:e,files:t})).unwrap().then(()=>{s((0,y.wp)({type:I.N.Success,message:p("electronicLogBook.logSuccess")})),h(1),m([0]),F({0:{categoryId:"",description:"",tags:[],tagInput:"",facility:"",file:null,fileName:""}}),o&&(s((0,B.VV)({shiftAorId:o,sortBy:"updatedAt",sortOrder:"desc",page:1,limit:10})),s((0,B.np)(!0)))}).catch(e=>{s((0,y.wp)({type:I.N.Error,message:e}))})},children:p("electronicLogBook.save")})]})]})]}),(0,r.jsx)(S.Z,{open:j,onClose:X,title:p("electronicLogBook.uploadAttachment"),actionLabel:p("electronicLogBook.upload"),cancelLabel:p("electronicLogBook.cancel"),width:500,onAction:()=>{null!==z&&T?(N(z,{file:T,fileName:T.name}),X()):s((0,y.wp)({type:I.N.Error,message:p("electronicLogBook.uploadFile")}))},children:(0,r.jsx)(i.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:(0,r.jsx)(R.Z,{onChange:e=>{e&&null!==z&&W(e)},onValidationError:e=>{s((0,y.wp)({type:I.N.Error,message:e}))},accept:k.lJ,maxFileSizeMB:10})})})]})},D=e=>{let{showToggleIcon:t,showMaximizeIcon:o,showMinimizeIcon:A,onToggleLogbook:S,onMaximizeLogbook:R,onMinimizeLogbook:Z,onExportCSV:E}=e,D=(0,l.H)(),T=(0,w.T)(),{aors:W,activeTab:V,showAddRow:N,selectedAOR:O,logEntries:M,totalEntries:_}=(0,w.C)(e=>e.electronicLog),P=W[V],H=null==P?void 0:P._id,U=(0,w.C)(e=>H?e.electronicLog.aorStates[H]||{filterTab:"all",sortBy:"updatedAt",sortOrder:"desc",currentPage:1,currentLimit:10,search:""}:null),{filterTab:Q,search:Y}=U||{},K=(0,n.useRef)(null),{t:X}=(0,v.$)(),$=M[0],q=(null==$?void 0:$.updatedAt)?(0,j.Q)(new Date($.updatedAt),{addSuffix:!1}):null,[G,J]=(0,n.useState)(null),ee=()=>{J(null)},et=e=>{E?E(e):T((0,y.wp)({type:I.N.Error,message:X("electronicLogBook.exportNotAvailable")})),ee()},eo=async()=>{if(O)try{let e=await T((0,B.Kb)(O)).unwrap(),t=window.URL.createObjectURL(e),o=document.createElement("a");o.href=t,o.download="logbook_".concat(O,".pdf"),document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(t)}catch(e){T((0,y.wp)({type:I.N.Error,message:"string"==typeof e?e:X("electronicLogBook.failDownloadPdf")}))}};(0,n.useEffect)(()=>{T((0,B.CP)()),T((0,B._L)()).then(e=>{if(B._L.fulfilled.match(e)){let{aors:t}=e.payload;if(Array.isArray(t)&&t.length>0){let e=[...t].sort((e,t)=>{let o=!!e.shiftId&&!!e.shiftAorId;return Number(!!t.shiftId&&!!t.shiftAorId)-Number(o)}),o=e.findIndex(e=>!0===e.isActiveTab),r=e[-1!==o?o:0];(null==r?void 0:r._id)&&(T((0,B.l2)(r._id)),T((0,F.aM)(r._id)),T((0,B.Ax)({aorId:r._id,filterTab:"all"})),T((0,B.VV)({shiftAorId:r._id,sortBy:"updatedAt",sortOrder:"desc",filter:"all",search:"",page:1,limit:10})))}}})},[T]),(0,n.useEffect)(()=>{if(W.length>0&&K.current){let e=K.current.querySelectorAll('[role="tab"]');C(K.current,e,V)}},[W,V]);let er=e=>{if(H){T((0,B.Ax)({aorId:H,filterTab:e})),T((0,B.QK)({aorId:H,currentPage:1})),T((0,B.BX)({aorId:H,currentLimit:10}));let t=(null==U?void 0:U.search)||"";T((0,B.VV)({shiftAorId:H,sortBy:(null==U?void 0:U.sortBy)||"updatedAt",sortOrder:(null==U?void 0:U.sortOrder)||"desc",filter:e.toLowerCase(),search:t,page:1,limit:10}))}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i.Z,{sx:D.tabsContainer,children:[(0,r.jsx)(a.Z,{value:V,onChange:(e,t)=>{T((0,B.r7)(t));let o=W[t];(null==o?void 0:o._id)&&(T((0,F.aM)(o._id)),T((0,B.l2)(o._id)),T((0,B.Qf)()),T((0,B.Ax)({aorId:o._id,filterTab:"all"})),T((0,B.EQ)({aorId:o._id,sortBy:"updatedAt"})),T((0,B.Rs)({aorId:o._id,sortOrder:"desc"})),T((0,B.QK)({aorId:o._id,currentPage:1})),T((0,B.BX)({aorId:o._id,currentLimit:10})),T((0,B.xR)({aorId:o._id,search:""})),T((0,B.VV)({shiftAorId:o._id,sortBy:"updatedAt",sortOrder:"desc",filter:"all",search:"",page:1,limit:10}))),setTimeout(()=>{if(!K.current)return;let e=K.current.querySelectorAll('[role="tab"]');C(K.current,e,t)},100)},sx:D.tabsFlexContainer,ref:K,variant:"scrollable",scrollButtons:"auto",children:W.map((e,t)=>{let o=V===t,n=(null==P?void 0:P.shiftId)&&(null==P?void 0:P.shiftAorId);return(0,r.jsx)(s.Z,{label:(0,r.jsxs)(i.Z,{sx:D.tabWithDot,children:[(0,r.jsx)(m.Z,{sx:{...D.tabDot,color:e.color}}),e.name]}),sx:{...D.tab,...o&&n?{backgroundColor:"#00010385",fontWeight:"bold"}:{},minWidth:120,marginRight:2}},e._id)})}),(0,r.jsxs)(i.Z,{sx:D.headerActionsContainer,children:[t&&(0,r.jsx)("img",{src:k.VZ.toggleIcon,alt:"toggle",width:28,height:26,style:D.headerIcon,onClick:S}),o&&(0,r.jsx)("img",{src:k.VZ.maximizeIcon,alt:"maximize",width:30,height:34,style:D.headerIconMaximize,onClick:R}),A&&(0,r.jsx)("img",{src:k.VZ.minimizeIcon,alt:"minimize",width:20,height:20,style:D.headerIconMinimize,onClick:Z}),(0,r.jsx)(L.y,{allowedRoles:["Administrator","Active Controller"],children:(null==P?void 0:P.shiftId)&&(null==P?void 0:P.shiftAorId)&&(0,r.jsx)("img",{src:k.VZ.add,alt:"add",width:24,height:24,style:{...D.headerIconAdd,transform:N?"rotate(45deg)":"rotate(0deg)",transition:"transform 0.3s ease-in-out"},onClick:()=>{T((0,B.np)(!N))}})})]})]}),!N&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Z,{sx:D.topBar,children:(0,r.jsxs)(i.Z,{sx:D.topBarContent,children:[(0,r.jsxs)(i.Z,{sx:D.topBarHeader,children:[(0,r.jsx)(c.Z,{sx:D.title,children:X("electronicLogBook.title")}),(0,r.jsxs)(L.y,{allowedRoles:["Administrator","Active Controller"],children:[(0,r.jsx)(d.Z,{variant:"outlined",sx:D.exportButton,onClick:e=>{J(e.currentTarget)},startIcon:(0,r.jsx)(i.Z,{sx:D.exportIconContainer,children:(0,r.jsx)("img",{src:k.VZ.upload,alt:"export",width:20,height:20,style:D.exportIcon})}),children:X("electronicLogBook.export")}),(0,r.jsxs)(p.Z,{anchorEl:G,open:!!G,onClose:ee,MenuListProps:{"aria-labelledby":"export-button"},PaperProps:{sx:{background:"#1A1A1A26",backdropFilter:"blur(16.25px)",boxSizing:"border-box",marginTop:0,color:"#fff",boxShadow:"\n        8.13px 8.13px 24.38px -5.2px #FFFFFF66 inset,\n        -16.25px -8.13px 8.13px -5.2px #FFFFFF33 inset,\n        0px 0px 20.8px -5.2px #FFFFFF33 inset\n      ",borderRadius:2,padding:.5,border:"1px solid rgba(255, 255, 255, 0.1)",fontSize:"0.3rem"}},children:[(0,r.jsx)(g.Z,{onClick:()=>et(k.b2),children:X("electronicLogBook.asCSV")}),(0,r.jsx)(g.Z,{onClick:()=>et(k.AM),children:X("electronicLogBook.asEXCEL")}),(0,r.jsx)(g.Z,{onClick:eo,children:X("electronicLogBook.asPDF")})]})]})]}),(0,r.jsxs)(i.Z,{sx:D.topBarStatusContainer,children:[(0,r.jsxs)(i.Z,{sx:D.topBarStatusItem,children:[(0,r.jsx)(b.Z,{sx:D.statusIcon}),X("electronicLogBook.lastEntry"),":"," ",q?"".concat(q):X("electronicLogBook.noEntry")]}),(0,r.jsxs)(i.Z,{sx:D.topBarStatusItem,children:[(0,r.jsx)(m.Z,{sx:D.statusDot}),_," ",X("electronicLogBook.entries")]})]})]})}),(0,r.jsxs)(i.Z,{sx:D.filterSearchContainer,children:[(0,r.jsxs)(i.Z,{sx:D.tabbContainer,children:[(0,r.jsx)(d.Z,{variant:"outlined",onClick:()=>er(k.QN),sx:{...D.tabb,...D.tabbLeftRadius,...Q===k.QN?{backgroundColor:"rgba(25, 118, 210, 0.15)",color:"white"}:{}},children:X("electronicLogBook.allEntries")}),(0,r.jsx)(d.Z,{variant:"outlined",onClick:()=>er(k.MY),sx:{...D.tabb,...Q===k.MY?{backgroundColor:"rgba(25, 118, 210, 0.15)",color:"white"}:{}},children:X("electronicLogBook.myEntries")}),(0,r.jsx)(d.Z,{variant:"outlined",onClick:()=>er(k.fo),sx:{...D.tabb,...D.tabbRightRadius,...Q===k.fo?{backgroundColor:"rgba(25, 118, 210, 0.15)",color:"white"}:{}},children:X("electronicLogBook.important")})]}),(0,r.jsxs)(i.Z,{sx:D.filterSearchContainer,display:"flex",alignItems:"center",gap:0,children:[(0,r.jsx)(u.Z,{variant:"outlined",size:"small",sx:{minWidth:10,marginRight:-8,bgcolor:"transparent",backdropFilter:"blur(16.25px)",borderRadius:2,border:"1px solid #fff",color:"#fff","& .MuiSelect-icon":{color:"#fff"},"& .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255, 255, 255, 0.1)"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#eef2f5ff"}},children:(0,r.jsx)(f.Z,{value:(null==U?void 0:U.currentLimit)||10,onChange:e=>{let t=e.target.value;H&&(T((0,B.BX)({aorId:H,currentLimit:t})),T((0,B.VV)({shiftAorId:H,sortBy:(null==U?void 0:U.sortBy)||"updatedAt",sortOrder:(null==U?void 0:U.sortOrder)||"desc",filter:(null==U?void 0:U.filterTab.toLowerCase())||"all",search:(null==U?void 0:U.search)||"",page:1,limit:t})))},displayEmpty:!0,inputProps:{"aria-label":"page limit"},sx:{color:"#fff","& .MuiSelect-select":{padding:"8px 24px 8px 12px"}},children:[10,20,30,40,50].map(e=>(0,r.jsx)(g.Z,{value:e,children:e},e))})}),(0,r.jsx)(i.Z,{sx:D.searchContainer,flexGrow:1,children:(0,r.jsxs)(i.Z,{sx:D.searchBar,children:[(0,r.jsx)(h.Z,{sx:D.searchIcon}),(0,r.jsx)(x.ZP,{placeholder:X("electronicLogBook.search"),value:Y,onChange:e=>{let t=e.target.value;H&&(T((0,B.xR)({aorId:H,search:t})),T((0,B.VV)({shiftAorId:H,sortBy:null==U?void 0:U.sortBy,sortOrder:null==U?void 0:U.sortOrder,filter:null==U?void 0:U.filterTab.toLowerCase(),search:t,page:1,limit:10})))},sx:D.searchInput,type:"text"})]})})]})]})]}),N&&H&&O&&(0,r.jsx)(z,{currentAorId:H,selectedAOR:O})]})},T=o(18150),W=o(477203),V=o(258609),N=o(155790),O=o(981435),M=e=>{var t,o,i;let{logEntry:l,onSuccess:a,onCancel:s}=e,{t:c}=(0,v.$)(),d=(0,w.T)(),p=(0,w.C)(e=>e.electronicLog.categories);(0,n.useEffect)(()=>{d((0,B.CP)())},[d]);let g=p.map(e=>({label:e.name,value:e._id})),u=[{name:"categoryId",label:c("electronicLogBook.category"),type:"select",required:!0,options:g,placeholder:c("electronicLogBook.selectOption")},{name:"tags",label:c("electronicLogBook.tags"),type:"tags",placeholder:c("electronicLogBook.tagValid")},{name:"facilities",label:c("electronicLogBook.facility"),type:"text",placeholder:c("electronicLogBook.enterFacility")},{name:"description",label:c("electronicLogBook.description"),type:"textarea",required:!0,placeholder:c("electronicLogBook.enterDesc")},{name:"file1",type:"file",label:"Attachment",accept:k.lJ,maxFileSizeMB:1}],f={categoryId:(null===(t=l.categoryId)||void 0===t?void 0:t._id)||"",tags:(null===(o=l.tags)||void 0===o?void 0:o.join(", "))||"",facilities:(null===(i=l.facilityIds)||void 0===i?void 0:i.map(e=>e.name).join(", "))||"",description:l.description||""},x=async e=>{try{let t=e.file1,o={categoryId:e.categoryId,tags:"string"==typeof e.tags?e.tags:"",facilities:"string"==typeof e.facilities?e.facilities:"",description:e.description,filename:null==t?void 0:t.name};await d((0,B.cM)({logId:l._id,payload:o,files:t?[t]:[]})).unwrap(),d((0,y.wp)({type:I.N.Success,message:c("electronicLogBook.updateSuccess")})),null==a||a(),null==s||s()}catch(e){d((0,y.wp)({message:"string"==typeof e?e:c("electronicLogBook.updateFailed"),type:I.N.Error}))}};return(0,r.jsx)(O.Z,{fields:u,onSubmit:x,onCancel:s,submitLabel:c("electronicLogBook.update"),cancelLabel:c("electronicLogBook.cancel"),initialValues:f})},_=o(843244),P=e=>{let{onExportReady:t}=e,o=(0,l.H)(),a=(0,w.T)(),{logEntries:s,selectedAOR:d}=(0,w.C)(e=>e.electronicLog),p=(0,w.C)(e=>d?e.electronicLog.aorStates[d]||{filterTab:"all",sortBy:"updatedAt",sortOrder:"desc",currentPage:1,currentLimit:10,search:""}:null),{filterTab:g,sortBy:u,sortOrder:f}=p||{},{t:x}=(0,v.$)(),h=(0,n.useRef)(null),[b,m]=(0,n.useState)(null);(0,n.useEffect)(()=>{d&&p&&(a((0,B.VV)({shiftAorId:d,sortBy:p.sortBy,sortOrder:p.sortOrder,filter:p.filterTab.toLowerCase(),search:p.search,page:p.currentPage,limit:p.currentLimit})),a((0,B.np)(!1)),a((0,B.a1)({aorId:d})))},[a,d]),(0,n.useEffect)(()=>{h.current&&t&&t(h.current)},[t]);let C=async(e,t)=>{try{let o=await fetch(e,{mode:"cors"}),r=await o.blob(),n=window.URL.createObjectURL(r),i=document.createElement("a");i.href=n,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(n)}catch(t){window.open(e,"_blank")}},F=()=>{d&&p&&a((0,B.VV)({shiftAorId:d,sortBy:p.sortBy,sortOrder:p.sortOrder,filter:p.filterTab.toLowerCase(),search:p.search,page:p.currentPage,limit:p.currentLimit}))},j=e=>{a((0,B.I2)(e)),a((0,B.u4)(e)).unwrap().then(e=>{a((0,y.wp)({type:I.N.Success,message:e.message}))}).catch(t=>{a((0,B.I2)(e)),a((0,y.wp)({type:I.N.Error,message:t}))}),F()},R=(e,t,o)=>{let n=o(e[t]),i=n.length>12?"".concat(n.slice(0,12),"..."):n;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(L.y,{allowedRoles:["Administrator","Active Controller"],children:(0,r.jsx)(A.Z,{size:"small",onClick:()=>j(e._id),sx:{padding:0,marginRight:1},children:e.isImportant?(0,r.jsx)(V.Z,{sx:{color:"#FFD700"}}):(0,r.jsx)(W.Z,{sx:{color:"#999"}})})}),(0,r.jsx)(T.Z,{title:n.length>12?n:"",children:(0,r.jsx)("span",{children:i})})]})},Z=[{label:x("electronicLogBook.category"),field:"categoryId",sortKey:"category",sortable:!0,render:e=>R(e,"categoryId",e=>(null==e?void 0:e.name)||"-"),exportValue:e=>{var t;return(null===(t=e.categoryId)||void 0===t?void 0:t.name)||"-"}},{label:x("electronicLogBook.facility"),field:"facilityIds",sortKey:"facility",sortable:!0,render:e=>{var t,o;return(null===(o=e.facilityIds)||void 0===o?void 0:null===(t=o[0])||void 0===t?void 0:t.name)||"-"}},{label:x("electronicLogBook.description"),field:"description",sortable:!0},{label:x("electronicLogBook.lastUpdated"),field:"updatedAt",sortable:!0,render:e=>new Date(e.updatedAt).toLocaleString()},{label:x("electronicLogBook.createdBy"),field:"createdBy",sortable:!0,render:e=>{var t;return(null===(t=e.createdBy)||void 0===t?void 0:t.username)||"-"}},{label:x("electronicLogBook.tags"),field:"tags",sortable:!0,renderType:"tags"}],E=[{icon:(0,r.jsx)("img",{src:k.VZ.edit,width:20,height:20}),tooltip:x("common.edit"),onClick:e=>{m(e)},show:e=>!0===e.isNew},{icon:(0,r.jsx)("img",{src:k.VZ.delete,width:20,height:20}),tooltip:x("common.delete"),onClick:e=>{a((0,B.Nw)(e._id)).unwrap().then(e=>{a((0,y.wp)({type:I.N.Success,message:e.message})),F()}).catch(e=>{a((0,y.wp)({type:I.N.Error,message:e}))})},show:e=>!0===e.isNew},{icon:(0,r.jsx)("img",{src:k.VZ.download,width:24,height:24}),tooltip:x("electronicLogBook.download"),onClick:e=>{var t;let o=null===(t=e.fileUrls)||void 0===t?void 0:t[0];o&&C(o,o.split("/").pop()||x("electronicLogBook.download"))},show:e=>Array.isArray(e.fileUrls)&&e.fileUrls.length>0}];return(0,r.jsxs)(r.Fragment,{children:[(g===k.QN||g===k.MY||g===k.fo)&&(0===s.length?(0,r.jsx)(i.Z,{sx:o.noEntriesContainer,children:(0,r.jsx)(c.Z,{sx:o.noEntriesText,children:x("electronicLogBook.noDataFound")})}):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(N.Z,{headers:Z,rows:s,sortBy:u,sortOrder:f,onSort:e=>{if(d&&p){let t,o=e;p.sortBy===e?t=p.sortOrder===k.zE?k.hr:k.zE:(o=e,t=k.zE),a((0,B.EQ)({aorId:d,sortBy:o})),a((0,B.Rs)({aorId:d,sortOrder:t})),a((0,B.VV)({shiftAorId:d,sortBy:o,sortOrder:t,filter:p.filterTab.toLowerCase(),search:p.search,page:p.currentPage,limit:p.currentLimit||10}))}},actions:E,styles:_.V,noDataMessage:x("electronicLogBook.noDataFound"),onExport:e=>{h.current=e}})})),b&&(0,r.jsx)(S.Z,{open:!!b,onClose:()=>m(null),onAction:()=>{F(),m(null)},title:"Edit Log Entry",width:800,children:(0,r.jsx)(M,{logEntry:b,onSuccess:()=>{F(),m(null)},onCancel:()=>m(null)})})]})},H=o(451283),U=e=>{let{showToggleIcon:t,showMaximizeIcon:o,showMinimizeIcon:a,onToggleLogbook:s,onMaximizeLogbook:c,onMinimizeLogbook:d}=e,p=(0,l.H)(),{t:g}=(0,v.$)(),u=(0,w.T)(),{selectedAOR:f}=(0,w.C)(e=>e.electronicLog),x=(0,w.C)(e=>f?e.electronicLog.aorStates[f]:null),{totalPages:h}=(0,w.C)(e=>e.electronicLog),{currentPage:b=1,currentLimit:m=10}=x||{},[C,F]=(0,n.useState)(null),j=(0,n.useRef)(null);return(0,r.jsxs)(i.Z,{sx:p.container,children:[(0,r.jsx)(D,{showToggleIcon:t,showMaximizeIcon:o,showMinimizeIcon:a,onToggleLogbook:s,onMaximizeLogbook:c,onMinimizeLogbook:d,onExportCSV:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k.b2;if(j.current)try{j.current(e),u((0,y.wp)({type:I.N.Success,message:g("electronicLogBook.exportSuccess")}))}catch(e){u((0,y.wp)({type:I.N.Error,message:g("electronicLogBook.exportFailed")}))}else u((0,y.wp)({type:I.N.Error,message:g("electronicLogBook.exportNotAvailable")}))}}),(0,r.jsx)(i.Z,{sx:p.scrollableContent,children:(0,r.jsx)(P,{onExportReady:e=>{j.current=e}})}),(0,r.jsx)(H.Z,{currentPage:b,totalPages:h,currentLimit:m,onPageChange:(e,t)=>{f&&x&&(u((0,B.QK)({aorId:f,currentPage:e})),u((0,B.VV)({shiftAorId:f,sortBy:x.sortBy,sortOrder:x.sortOrder,filter:x.filterTab.toLowerCase(),search:x.search,page:e,limit:t})))},showPagination:h>1})]})}},5894:function(e,t,o){o.d(t,{H:function(){return r}});let r=()=>({container:{background:"#1A1A1A26",backdropFilter:"blur(50.25px)",borderRadius:"20px",borderTop:"4px solid #3D96E1",boxShadow:"\n    8.13px 8.13px 24.38px -5.2px #FFFFFF66 inset,\n    -16.25px -8.13px 8.13px -5.2px #FFFFFF33 inset,\n    0px 0px 20.8px -5.2px #FFFFFF33 inset\n  ",overflow:"hidden",width:"100%",height:"100%",display:"flex",flexDirection:"column"},tabsContainer:{backgroundColor:"#FFFFFF45",minHeight:0,padding:"0 10px",display:"flex",alignItems:"center",justifyContent:"space-between","& .MuiTabs-flexContainer":{gap:0},"& .MuiTabs-indicator":{display:"none"}},tabsFlex:{flex:1},noScrollBar:{overflowY:"scroll",scrollbarWidth:"none",msOverflowStyle:"none","&::-webkit-scrollbar":{display:"none"}},tab:{height:10,px:3,textTransform:"none",fontSize:"0.8rem",fontWeight:500,color:"#fff",backgroundColor:"transparent",borderRadius:"8px 8px 0 0",minWidth:"auto","&.Mui-selected":{color:"#FFF",fontWeight:500,py:3,backgroundColor:"#69728585"}},exportButton:{background:"transparent",color:"#fff",borderRadius:2,fontWeight:400,fontSize:"1rem",padding:"4px 8px",cursor:"pointer",border:"0.5px solid #fff",transition:"background 0.2s","&:disabled":{opacity:.5,color:"#fff",borderColor:"#fff",cursor:"not-allowed"}},tabContentWrapper:{display:"flex",flexDirection:"column",alignItems:"center"},activeTabIndicator:{width:"100%",height:2,borderRadius:2},tabLabel:{display:"flex",alignItems:"center",gap:1},header:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:24,paddingBottom:8,borderBottom:"1.5px solid #2C3E50"},title:{color:"#fff",fontSize:"1rem",fontWeight:600,mb:.5},tabs:{display:"flex",gap:12,alignItems:"center"},searchBar:{display:"flex",alignItems:"center",gap:1,margin:"12px 0",background:"transparent",borderRadius:2,padding:"2px 12px",border:"1px solid #fff"},searchInput:{flex:1,background:"transparent",border:"none",color:"#fff",fontSize:"1rem",outline:"none",padding:"2px 0"},filterButton:{background:"linear-gradient(160.41deg, rgba(111, 185, 248, 0.5) -5.15%, rgba(61, 150, 225, 0.5) 87.35%)",boxShadow:"\n      0px 3px 4px 0px #DFEEFF4D inset,\n      0px 1px 1px 0px #FFFFFF59 inset,\n      0px -2px 2px 0px #00428926 inset,\n      0px 2px 3px 0px #347CD14D\n    ",backdropFilter:"blur(5.25px)",WebkitBackdropFilter:"blur(5.25px)",color:"#FFFFFF",borderRadius:24,px:4,fontWeight:500,fontSize:"0.8rem",textTransform:"none",height:38},addButton:{background:"#A0A3BD47",backdropFilter:"blur(5.25px)",WebkitBackdropFilter:"blur(5.25px)",color:"#fff",borderRadius:24,px:4,fontWeight:500,fontSize:"0.8rem",textTransform:"none",height:38,border:"none"},tableContainer:{background:"#1B2B3C",borderRadius:12,overflow:"auto"},table:{width:"100%",borderCollapse:"separate",borderSpacing:0,color:"#fff",fontSize:"0.98rem"},tableHead:{background:"#22344A",fontWeight:700,color:"#A0A3BD"},tableRow:{borderBottom:"1px solid #2C3E50","&:hover":{background:"#22344A55"}},tableCell:{padding:"12px 10px",textAlign:"left",fontWeight:500,color:"#fff",borderBottom:"1px solid #2C3E50"},statusChip:e=>({display:"inline-block",padding:"4px 12px",borderRadius:12,background:e,color:"#fff",fontWeight:600,fontSize:"0.9rem",minWidth:60,textAlign:"center"}),iconButton:{background:"none",border:"none",color:"#A0A3BD",cursor:"pointer",fontSize:"1.1rem",margin:"0 4px","&:hover":{color:"#3D96E1"}},topBar:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 16px 0 16px",background:"transparent",minHeight:48,width:"100%"},topBarTitle:{fontSize:"1.2rem",fontWeight:700,color:"#fff",marginRight:24},topBarStatus:{display:"flex",alignItems:"center",gap:16,color:"#A0A3BD",fontSize:"0.95rem",flex:1},topBarStatusItem:{display:"flex",alignItems:"center",gap:1,color:"#3B96E1",fontSize:"0.95rem"},topBarActions:{display:"flex",alignItems:"center",gap:8},topBarButton:{background:"none",border:"none",color:"#A0A3BD",fontSize:"1.3rem",borderRadius:"50%",width:36,height:36,display:"flex",alignItems:"center",justifyContent:"center",transition:"background 0.2s",cursor:"pointer","&:hover":{background:"#22344A",color:"#3D96E1"}},tabbContainer:{display:"flex",border:"1px solid #fff",borderRadius:2,overflow:"hidden",alignItems:"stretch",justifyContent:"flex-start",mt:1,height:40,width:"30%"},tabb:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",color:"#fff",fontWeight:400,fontSize:"0.8rem",cursor:"pointer",transition:"background 0.2s",userSelect:"none",height:40,background:"transparent",boxShadow:"none",borderRight:"1px solid #FFF",borderRadius:0,minWidth:70,"&:last-of-type":{borderRight:"none"}},micButton:{background:"none",color:"#A0A3BD",border:"1px solid #fff",borderRadius:"50%",width:40,height:40,display:"flex",alignItems:"center",justifyContent:"center",transition:"background 0.2s",cursor:"pointer","&:hover":{background:"#22344A",color:"#3D96E1"}},tableHeaderCell:{color:"#fff",fontWeight:500},tableBodyCell:{color:"#fff",fontWeight:500},tableHeaderRow:{background:"#3D96E1"},noDataRow:{color:"#fff",paddingTop:4,paddingBottom:4},tableBodyRow:{background:"#1A1A1A26",borderBottom:"2px solid #FFF",cursor:"pointer",fontSize:"0.9rem","&:hover":{background:"rgba(255, 255, 255, 0.05)"}},tabsFlexContainer:{minHeight:0,overflowX:"auto",overflowY:"hidden",scrollbarWidth:"none",msOverflowStyle:"none","&::-webkit-scrollbar":{display:"none"},"& .MuiTabs-flexContainer":{gap:0,minWidth:"max-content"},"& .MuiTabs-indicator":{display:"none"}},tabWithDot:{display:"flex",alignItems:"center",gap:1},tabDot:{fontSize:12},tabSelected:{color:"#FFF",fontWeight:500,py:3,backgroundColor:"#5e544285"},headerActionsContainer:{display:"flex",alignItems:"center",gap:1,ml:2},headerIcon:{objectFit:"contain",cursor:"pointer"},headerIconMaximize:{cursor:"pointer"},headerIconMinimize:{cursor:"pointer"},headerIconAdd:{cursor:"pointer"},topBarContent:{display:"flex",flexDirection:"column",flex:1},topBarHeader:{display:"flex",alignItems:"center",justifyContent:"space-between"},topBarStatusContainer:{display:"flex",gap:2},filterSearchContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",px:2},searchContainer:{display:"flex",alignItems:"center",gap:1,minWidth:350,flex:1,justifyContent:"flex-end"},tabbLeftRadius:{borderTopLeftRadius:8,borderBottomLeftRadius:8},tabbRightRadius:{borderTopRightRadius:8,borderBottomRightRadius:8,borderRight:"none"},addRowContainer:{mt:3,px:1,display:"flex",flexDirection:"column",gap:2},addRowScrollableContent:{maxHeight:120,overflowY:"auto",display:"flex",flexDirection:"column",gap:2,paddingRight:1,"&::-webkit-scrollbar":{width:8},"&::-webkit-scrollbar-track":{background:"rgba(255, 255, 255, 0.1)",borderRadius:4},"&::-webkit-scrollbar-thumb":{background:"rgba(255, 255, 255, 0.3)",borderRadius:4,"&:hover":{background:"rgba(255, 255, 255, 0.5)"}}},addRowItem:{display:"flex",alignItems:"center",gap:2},selectContainer:{minWidth:180,display:"flex",alignItems:"center",border:"1px solid #fff",background:"transparent",width:220,minHeight:40,padding:"2px 8px",whiteSpace:"nowrap",borderRadius:2,overflowX:"auto",overflowY:"hidden",scrollBehavior:"smooth","&::-webkit-scrollbar":{display:"none"},scrollbarWidth:"none",msOverflowStyle:"none"},selectInput:{width:"100%",border:"none",outline:"none",background:"transparent",color:"#fff",paddingLeft:8},selectOption:{background:"#1A1A1A26",backdropFilter:"blur(16.25px)",boxSizing:"border-box",boxShadow:"\n    inset 8.13px 8.13px 24.38px -5.2px #FFFFFF66,\n    inset -16.25px -8.13px 8.13px -5.2px #FFFFFF33,\n    inset 0px 0px 20.8px -5.2px #FFFFFF33\n  ",color:"#FFFFFF",borderRadius:"12px",padding:"8px 12px",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",position:"relative",zIndex:1,overflowY:"auto",scrollbarWidth:"thin",scrollbarColor:"#FFF transparent","&::-webkit-scrollbar":{width:"8px"},"&::-webkit-scrollbar-thumb":{background:"#FFF3",borderRadius:"8px"},"&::-webkit-scrollbar-track":{background:"transparent"}},textInput:{width:"100%",height:40,borderRadius:8,border:"1px solid #fff",background:"transparent",color:"#fff",paddingLeft:8},flexInput:{flex:1,display:"flex",alignItems:"center",border:"1px solid #fff",background:"transparent",width:220,minHeight:40,padding:"2px 8px",overflowX:"auto",whiteSpace:"nowrap",borderRadius:2},closeButtonContainer:{display:"flex",mt:1,gap:2,justifyContent:"space-between",alignItems:"center",px:1},exportIconContainer:{display:"flex",alignItems:"center"},exportIcon:{objectFit:"contain"},statusIcon:{fontSize:18,color:"#3D96E1"},statusDot:{fontSize:12,color:"#3D96E1"},searchIcon:{color:"#A0A3BD"},contentTableContainer:{background:"transparent",boxShadow:"none",borderRadius:4,mt:1,mb:2,overflow:"hidden",scrollbarWidth:"none",msOverflowStyle:"none","&::-webkit-scrollbar":{display:"none"}},contentTable:{minWidth:650},starIcon:{verticalAlign:"middle"},starIconBookmarked:{color:"#FFD600",verticalAlign:"middle"},starIconUnbookmarked:{color:"#FFF",verticalAlign:"middle"},tagChip:{marginRight:.5,background:"#22344A",color:"#fff"},actionIcon:{verticalAlign:"middle"},scrollableContent:{flex:1,overflowY:"auto",overflowX:"hidden",padding:"16px",scrollBehavior:"smooth",transition:"all 0.3s ease-in-out","&::-webkit-scrollbar":{width:8},"&::-webkit-scrollbar-track":{background:"rgba(255, 255, 255, 0.1)",borderRadius:4},"&::-webkit-scrollbar-thumb":{background:"rgba(255, 255, 255, 0.3)",borderRadius:4,"&:hover":{background:"rgba(255, 255, 255, 0.5)"}}},scrollButton:{color:"#fff",backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:"50%",width:32,height:32,margin:"0 4px","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.2)"},"&:disabled":{color:"rgba(255, 255, 255, 0.3)",backgroundColor:"transparent"}},noEntriesContainer:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px",flexDirection:"column",gap:2},noEntriesText:{color:"#FFF",fontSize:"18px"},filecount:{position:"absolute",top:-8,right:-8,backgroundColor:"#1976d2",color:"white",borderRadius:"50%",width:16,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",fontWeight:"bold"},inputfield:{minWidth:60,flex:1,border:"none",outline:"none",background:"transparent",color:"#fff",boxShadow:"none",padding:0,margin:0,fontSize:14,width:100},status:{fontWeight:"bold",borderRadius:"12px",px:1.5,py:.5,color:"#fff"}})}}]);