(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[375],{347312:function(e,t,r){Promise.resolve().then(r.bind(r,862441))},862441:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return b}});var n=r(557437),i=r(902265),s=r(938543),a=r(790658),o=r(977639),u=r(408319),l=r(433145),c=r(720280),d=r(633623),h=r(842858),f=r(591925),g=r(799376),p=r(118627),x=r(899765),m=r(560087),v=r(86586),Z=r(62e4),j=()=>{let[e,t]=(0,i.useState)(null),[r,j]=(0,i.useState)(""),b=(0,i.useRef)(null),S=(0,g.useRouter)(),w=(0,h.T)(),{t:Q}=(0,p.$)(),[C,W]=(0,i.useState)(!1),A=(0,h.C)(e=>e.onboarding.signatureBase64),{user:y,selectedRole:k}=(0,h.C)(e=>e.auth);(0,i.useEffect)(()=>{let e=localStorage.getItem("userSignatureBase64");e&&!A&&w((0,v.xG)(e))},[w,A]);let R=e=>{if(e){if(e.name.toLowerCase().endsWith(".jfif")){j("".concat(Q("uploadSignature.jfifNotAllowed")||"JFIF files are not allowed")),t(null),b.current&&(b.current.value="");return}if(!d.MF.includes(e.type)){j("".concat(Q("uploadSignature.onlyJpgPngAllowed"))),t(null),b.current&&(b.current.value="");return}if(e.size>d.nq){j("".concat(Q("uploadSignature.fileSizeError"))),t(null),b.current&&(b.current.value="");return}t(e),j("")}},N=async()=>{if(!e&&!A){w((0,x.wp)({message:"".concat(Q("uploadSignature.uploadSignatureError")),type:m.N.Error}));return}if(!e&&A){W(!0);let e=null==y?void 0:y.activeShiftCount,t=(0,f.k8)(null!=k?k:Z.i.ActiveController,null!=e?e:0);S.push(t);return}if(!e)return;let t=await w((0,v.a4)(e));if(v.a4.fulfilled.match(t)){let r=new FileReader;r.onloadend=()=>{let e=r.result;localStorage.setItem("userSignatureBase64",e),w((0,v.xG)(e)),w((0,x.wp)({message:t.payload.message,type:m.N.Success})),W(!0);let n=null==y?void 0:y.activeShiftCount,i=(0,f.k8)(null!=k?k:Z.i.ActiveController,null!=n?n:0);S.push(i)},r.readAsDataURL(e)}else w((0,x.wp)({message:t.payload||"".concat(Q("uploadSignature.uploadFailed")),type:m.N.Error})),W(!1)};return(0,n.jsxs)(s.Z,{sx:{...c.W2.cardContainer,maxWidth:640,width:"100%",px:0},children:[(0,n.jsxs)(s.Z,{sx:c.n.headerrow,children:[(0,n.jsx)(s.Z,{sx:c.n.titleicon,children:(0,n.jsx)(l.default,{src:d.VZ.esign,alt:"e-sign",width:32,height:32})}),(0,n.jsxs)(s.Z,{children:[(0,n.jsx)(a.Z,{sx:c.n.title,children:Q("uploadSignature.title")}),(0,n.jsx)(a.Z,{sx:c.n.subtitle,children:Q("uploadSignature.subtitle")})]})]}),(0,n.jsxs)(s.Z,{sx:c.n.dashedBox,onDrop:e=>{var t;e.preventDefault(),R(null===(t=e.dataTransfer.files)||void 0===t?void 0:t[0])},onDragOver:e=>{e.preventDefault()},onClick:e?void 0:()=>{var e;null===(e=b.current)||void 0===e||e.click()},children:[e||A?(0,n.jsxs)(s.Z,{sx:c.n.preview,children:[(0,n.jsx)("img",{src:e?URL.createObjectURL(e):A,alt:Q("uploadSignature.previewImageText"),style:{maxWidth:180,maxHeight:80,objectFit:"contain",borderRadius:6,margin:"12px 0"}}),(0,n.jsx)(o.Z,{variant:"contained",component:"span",sx:c.n.browseButton,onClick:e=>{e.stopPropagation(),t(null),w((0,v.xG)("")),b.current&&(b.current.value="")},disabled:C,children:Q("uploadSignature.clear")})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.default,{src:d.VZ.esign,alt:"e-sign",width:42,height:42}),(0,n.jsxs)(a.Z,{sx:c.n.fileText,children:[Q("uploadSignature.fileText"),(0,n.jsx)("br",{}),Q("uploadSignature.fileSizeText")]}),(0,n.jsx)(o.Z,{variant:"contained",component:"span",sx:c.n.browseButton,children:Q("uploadSignature.browseFile")})]}),(0,n.jsx)("input",{type:"file",accept:"image/png, image/jpeg, image/jpg, .png, .jpg, .jpeg",style:{display:"none"},ref:b,onChange:e=>{var t;R(null===(t=e.target.files)||void 0===t?void 0:t[0])}}),e&&(0,n.jsx)(a.Z,{sx:c.n.fileName,children:e.name}),r&&(0,n.jsx)(a.Z,{color:"error",sx:{mt:1,textAlign:"center"},children:r})]}),(0,n.jsx)(s.Z,{sx:c.W2.buttonContainer,children:(0,n.jsx)(o.Z,{variant:"contained",sx:c.W2.submitButton,onClick:N,children:C?(0,n.jsx)(u.Z,{size:24,sx:{color:"white"}}):(0,n.jsx)(a.Z,{sx:c.W2.submitButtonText,component:"span",children:Q("uploadSignature.continue")})})})]})};function b(){return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(j,{})})}},799376:function(e,t,r){"use strict";var n=r(635475);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},899765:function(e,t,r){"use strict";r.d(t,{M6:function(){return u},wp:function(){return o}});var n=r(620301),i=r(560087);let s={open:!1,message:"",type:i.N.Info},a=(0,n.oM)({name:"alert",initialState:s,reducers:{showAlert:(e,t)=>{e.open=!0,e.message=t.payload.message,e.type=t.payload.type||i.N.Info},closeAlert:e=>{e.open=!1,e.message=""}}}),{showAlert:o,closeAlert:u}=a.actions;t.ZP=a.reducer},62e4:function(e,t,r){"use strict";var n,i;r.d(t,{i:function(){return n}}),(i=n||(n={})).ActiveController="Active Controller",i.Administrator="Administrator",i.Observer="Observer"},560087:function(e,t,r){"use strict";var n,i;r.d(t,{N:function(){return n}}),(i=n||(n={})).Success="success",i.Error="error",i.Warning="warning",i.Info="info"},591925:function(e,t,r){"use strict";r.d(t,{R:function(){return a},k8:function(){return s}});var n=r(62e4),i=r(633623);let s=(e,t,r,s,a)=>{if(!s)return i.QZ.esign;if(!r)switch(e){case n.i.Administrator:return i.QZ.onboardingRoleSelection;case n.i.ActiveController:if(t&&t>0)return i.QZ.shiftChange;return i.QZ.onboardingHoursRest;case n.i.Observer:return i.QZ.onboardingObserver;default:return i.QZ.login}switch(e){case n.i.Administrator:if(a&&(a.startsWith(i.QZ.companies)||a.startsWith(i.QZ.user)||a.startsWith(i.QZ.aor)||a.startsWith(i.QZ.categories)||a.startsWith(i.QZ.roles)||a.startsWith(i.QZ.themes)))return a;return i.QZ.companies;case n.i.ActiveController:if(t&&t>0){if(a&&(a.startsWith(i.QZ.shiftChange)||a.startsWith(i.QZ.logbook)||a.startsWith(i.QZ.documents)||a.startsWith(i.QZ.help)))return a;return i.QZ.shiftChange}if(a&&a.startsWith("/dashboard/"))return a;return i.QZ.dashboard;case n.i.Observer:if(a&&(a.startsWith(i.QZ.logbook)||a.startsWith(i.QZ.shiftChange)||a.startsWith(i.QZ.documents)||a.startsWith(i.QZ.help)))return a;return i.QZ.dashboard;default:return i.QZ.login}},a=(e,t,r)=>{if(r)return!0;switch(e){case n.i.Administrator:return!1;case n.i.ActiveController:return!!(t&&t>0);case n.i.Observer:default:return!1}}}},function(e){e.O(0,[8969,6799,7639,3145,9885,280,2971,2117,1744],function(){return e(e.s=347312)}),_N_E=e.O()}]);